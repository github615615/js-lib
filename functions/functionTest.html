<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #root {
            border: 1px solid black;
            height: 1000px;
            width: 800px;
            float: left;
        }

        #root2 {
            border: 5px solid red;
            height: 1000px;
            width: 800px;
            float: left;
        }
    </style>
</head>

<body>
    <div id='root'></div>
    <pre id='root2'></pre>
    <script>
        // str1是转义一次之后的json字符串。str2就是一个json对象
        let str1 = `{\"name\":\"jn\",\"version\":\"0.1.0\",\"private\":true,\"dependencies\":{\"@pmmmwh/react-refresh-webpack-plugin\":\"0.4.2\",\"@svgr/webpack\":\"5.4.0\",\"@testing-library/jest-dom\":\"^5.11.5\",\"@testing-library/react\":\"^11.1.0\",\"@testing-library/user-event\":\"^12.1.10\",\"@typescript-eslint/eslint-plugin\":\"^4.5.0\",\"@typescript-eslint/parser\":\"^4.5.0\",\"axios\":\"^0.21.0\",\"babel-eslint\":\"^10.1.0\",\"babel-jest\":\"^26.6.0\",\"babel-plugin-named-asset-import\":\"^0.3.7\",\"babel-preset-react-app\":\"^10.0.0\",\"bfj\":\"^7.0.2\",\"camelcase\":\"^6.1.0\",\"case-sensitive-paths-webpack-plugin\":\"2.3.0\",\"css-loader\":\"4.3.0\",\"dotenv\":\"8.2.0\",\"dotenv-expand\":\"5.1.0\",\"eslint\":\"^7.11.0\",\"eslint-config-react-app\":\"^6.0.0\",\"eslint-plugin-flowtype\":\"^5.2.0\",\"eslint-plugin-import\":\"^2.22.1\",\"eslint-plugin-jest\":\"^24.1.0\",\"eslint-plugin-jsx-a11y\":\"^6.3.1\",\"eslint-plugin-react\":\"^7.21.5\",\"eslint-plugin-react-hooks\":\"^4.2.0\",\"eslint-plugin-testing-library\":\"^3.9.2\",\"eslint-webpack-plugin\":\"^2.1.0\",\"file-loader\":\"6.1.1\",\"fs-extra\":\"^9.0.1\",\"html-webpack-plugin\":\"4.5.0\",\"identity-obj-proxy\":\"3.0.0\",\"jest\":\"26.6.0\",\"jest-circus\":\"26.6.0\",\"jest-resolve\":\"26.6.0\",\"jest-watch-typeahead\":\"0.6.1\",\"js-md5\":\"^0.7.3\",\"lodash\":\"^4.17.20\",\"lodash-es\":\"^4.17.15\",\"mini-css-extract-plugin\":\"0.11.3\",\"optimize-css-assets-webpack-plugin\":\"5.0.4\",\"pnp-webpack-plugin\":\"1.6.4\",\"postcss-flexbugs-fixes\":\"4.2.1\",\"postcss-loader\":\"3.0.0\",\"postcss-normalize\":\"8.0.1\",\"postcss-preset-env\":\"6.7.0\",\"postcss-safe-parser\":\"5.0.2\",\"react\":\"^17.0.1\",\"react-app-polyfill\":\"^2.0.0\",\"react-dev-utils\":\"^11.0.0\",\"react-dom\":\"^17.0.1\",\"react-redux\":\"^7.2.2\",\"react-refresh\":\"^0.8.3\",\"react-router-dom\":\"^5.2.0\",\"react-thunk\":\"^1.0.0\",\"redux\":\"^4.0.5\",\"resolve\":\"1.18.1\",\"resolve-url-loader\":\"^3.1.2\",\"sass-loader\":\"8.0.2\",\"semver\":\"7.3.2\",\"style-loader\":\"1.3.0\",\"terser-webpack-plugin\":\"4.2.3\",\"ts-pnp\":\"1.2.0\",\"url-loader\":\"4.1.1\",\"web-vitals\":\"^0.2.4\",\"webpack-dev-server\":\"3.11.0\",\"webpack-manifest-plugin\":\"2.2.0\",\"workbox-webpack-plugin\":\"5.1.4\"},\"scripts\":{\"start\":\"node scripts/start.js\",\"build\":\"node scripts/build.js\",\"test\":\"node scripts/test.js\"},\"eslintConfig\":{\"extends\":[\"react-app\",\"react-app/jest\"]},\"browserslist\":{\"production\":[\">0.2%\",\"not dead\",\"not op_mini all\"],\"development\":[\"last 1 chrome version\",\"last 1 firefox version\",\"last 1 safari version\"]},\"devDependencies\":{\"@babel/core\":\"^7.12.3\",\"@babel/preset-env\":\"^7.12.1\",\"babel-core\":\"^6.26.3\",\"babel-loader\":\"^8.2.1\",\"babel-plugin-lodash\":\"^3.3.4\",\"babel-preset-env\":\"^1.7.0\",\"lodash-webpack-plugin\":\"^0.11.5\",\"redux-devtools\":\"^3.7.0\",\"webpack\":\"^4.44.2\",\"webpack-cli\":\"^4.2.0\"},\"jest\":{\"roots\":[\"<rootDir>/src\"],\"collectCoverageFrom\":[\"src/**/*.{js,jsx,ts,tsx}\",\"!src/**/*.d.ts\"],\"setupFiles\":[\"react-app-polyfill/jsdom\"],\"setupFilesAfterEnv\":[\"<rootDir>/src/setupTests.js\"],\"testMatch\":[\"<rootDir>/src/**/__tests__/**/*.{js,jsx,ts,tsx}\",\"<rootDir>/src/**/*.{spec,test}.{js,jsx,ts,tsx}\"],\"testEnvironment\":\"jsdom\",\"testRunner\":\"D:\\\\myreact_projects\\\\react_2\\\\jn\\\\node_modules\\\\jest-circus\\\\runner.js\",\"transform\":{\"^.+\\\\.(js|jsx|mjs|cjs|ts|tsx)$\":\"<rootDir>/node_modules/babel-jest\",\"^.+\\\\.css$\":\"<rootDir>/config/jest/cssTransform.js\",\"^(?!.*\\\\.(js|jsx|mjs|cjs|ts|tsx|css|json)$)\":\"<rootDir>/config/jest/fileTransform.js\"},\"transformIgnorePatterns\":[\"[/\\\\\\\\]node_modules[/\\\\\\\\].+\\\\.(js|jsx|mjs|cjs|ts|tsx)$\",\"^.+\\\\.module\\\\.(css|sass|scss)$\"],\"modulePaths\":[],\"moduleNameMapper\":{\"^react-native$\":\"react-native-web\",\"^.+\\\\.module\\\\.(css|sass|scss)$\":\"identity-obj-proxy\"},\"moduleFileExtensions\":[\"web.js\",\"js\",\"web.ts\",\"ts\",\"web.tsx\",\"tsx\",\"json\",\"web.jsx\",\"jsx\",\"node\"],\"watchPlugins\":[\"jest-watch-typeahead/filename\",\"jest-watch-typeahead/testname\"],\"resetMocks\":true},\"babel\":{\"presets\":[\"react-app\"]}}`
        let str2 = `{"name":"jn","version":"0.1.0","private":true,"dependencies":{"@pmmmwh/react-refresh-webpack-plugin":"0.4.2","@svgr/webpack":"5.4.0","@testing-library/jest-dom":"^5.11.5","@testing-library/react":"^11.1.0","@testing-library/user-event":"^12.1.10","@typescript-eslint/eslint-plugin":"^4.5.0","@typescript-eslint/parser":"^4.5.0","axios":"^0.21.0","babel-eslint":"^10.1.0","babel-jest":"^26.6.0","babel-plugin-named-asset-import":"^0.3.7","babel-preset-react-app":"^10.0.0","bfj":"^7.0.2","camelcase":"^6.1.0","case-sensitive-paths-webpack-plugin":"2.3.0","css-loader":"4.3.0","dotenv":"8.2.0","dotenv-expand":"5.1.0","eslint":"^7.11.0","eslint-config-react-app":"^6.0.0","eslint-plugin-flowtype":"^5.2.0","eslint-plugin-import":"^2.22.1","eslint-plugin-jest":"^24.1.0","eslint-plugin-jsx-a11y":"^6.3.1","eslint-plugin-react":"^7.21.5","eslint-plugin-react-hooks":"^4.2.0","eslint-plugin-testing-library":"^3.9.2","eslint-webpack-plugin":"^2.1.0","file-loader":"6.1.1","fs-extra":"^9.0.1","html-webpack-plugin":"4.5.0","identity-obj-proxy":"3.0.0","jest":"26.6.0","jest-circus":"26.6.0","jest-resolve":"26.6.0","jest-watch-typeahead":"0.6.1","js-md5":"^0.7.3","lodash":"^4.17.20","lodash-es":"^4.17.15","mini-css-extract-plugin":"0.11.3","optimize-css-assets-webpack-plugin":"5.0.4","pnp-webpack-plugin":"1.6.4","postcss-flexbugs-fixes":"4.2.1","postcss-loader":"3.0.0","postcss-normalize":"8.0.1","postcss-preset-env":"6.7.0","postcss-safe-parser":"5.0.2","react":"^17.0.1","react-app-polyfill":"^2.0.0","react-dev-utils":"^11.0.0","react-dom":"^17.0.1","react-redux":"^7.2.2","react-refresh":"^0.8.3","react-router-dom":"^5.2.0","react-thunk":"^1.0.0","redux":"^4.0.5","resolve":"1.18.1","resolve-url-loader":"^3.1.2","sass-loader":"8.0.2","semver":"7.3.2","style-loader":"1.3.0","terser-webpack-plugin":"4.2.3","ts-pnp":"1.2.0","url-loader":"4.1.1","web-vitals":"^0.2.4","webpack-dev-server":"3.11.0","webpack-manifest-plugin":"2.2.0","workbox-webpack-plugin":"5.1.4"},"scripts":{"start":"node scripts/start.js","build":"node scripts/build.js","test":"node scripts/test.js"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","babel-core":"^6.26.3","babel-loader":"^8.2.1","babel-plugin-lodash":"^3.3.4","babel-preset-env":"^1.7.0","lodash-webpack-plugin":"^0.11.5","redux-devtools":"^3.7.0","webpack":"^4.44.2","webpack-cli":"^4.2.0"},"jest":{"roots":["<rootDir>/src"],"collectCoverageFrom":["src/**/*.{js,jsx,ts,tsx}","!src/**/*.d.ts"],"setupFiles":["react-app-polyfill/jsdom"],"setupFilesAfterEnv":["<rootDir>/src/setupTests.js"],"testMatch":["<rootDir>/src/**/__tests__/**/*.{js,jsx,ts,tsx}","<rootDir>/src/**/*.{spec,test}.{js,jsx,ts,tsx}"],"testEnvironment":"jsdom","testRunner":"D:\myreact_projects\react_2\jn\node_modules\jest-circus\runner.js","transform":{"^.+\.(js|jsx|mjs|cjs|ts|tsx)$":"<rootDir>/node_modules/babel-jest","^.+\.css$":"<rootDir>/config/jest/cssTransform.js","^(?!.*\.(js|jsx|mjs|cjs|ts|tsx|css|json)$)":"<rootDir>/config/jest/fileTransform.js"},"transformIgnorePatterns":["[/\]node_modules[/\].+\.(js|jsx|mjs|cjs|ts|tsx)$","^.+\.module\.(css|sass|scss)$"],"modulePaths":[],"moduleNameMapper":{"^react-native$":"react-native-web","^.+\.module\.(css|sass|scss)$":"identity-obj-proxy"},"moduleFileExtensions":["web.js","js","web.ts","ts","web.tsx","tsx","json","web.jsx","jsx","node"],"watchPlugins":["jest-watch-typeahead/filename","jest-watch-typeahead/testname"],"resetMocks":true},"babel":{"presets":["react-app"]}}`
        // let jsonstr1 = JSON.parse(str1)
        // root.innerText = JSON.stringify(str2, null, 4)
        root2.innerText = formatJson(str1) //无法给字符串去转义，json字符串，是个字符串，
        // root2.innerText = formatJson(JSON.parse(JSON.stringify(str1, null, 4)));
        // root2.innerText=JSON.parse(str1) //变成了obj obj
        //root2.innerText=JSON.parse(JSON.parse(JSON.stringify(str1, null, 4))) //成了一行,JSON.stringify就是将字符串转义，多次调用它的话，会进行多次转义parse就是去转义，也可以多次调用
        console.log((JSON.stringify(str1, null, 4)))


        /* *
         * 格式化json字符串，必须在pre标签中，
         *  @params json{String | Object}参数可以是一个json对象，或者是一个json字符串,或者是一个转义后的json字符串,
         *  @return {String} 返回格式化完毕的js字符串，必须在pre标签中才行
         *  */
        function formatJson(json) {
            var outStr = '', //转换后的json字符串
                padIdx = 0, //换行后是否增减PADDING的标识
                space = '    '; //4个空格符
            if (typeof json !== 'string') {
                json = JSON.stringify(json);
            }

            json = json.replace(/([\{\}\[\]])/g, '\r\n$1\r\n')
                .replace(/(\,)/g, '$1\r\n')
                .replace(/(\r\n\r\n)/g, '\r\n');
            (json.split('\r\n')).forEach(function(node, index) {
                var indent = 0,
                    padding = '';
                if (node.match(/[\{\[]/)) {
                    indent = 1;
                } else if (node.match(/[\}\]]/)) {
                    padIdx = padIdx !== 0 ? --padIdx : padIdx;
                } else {
                    indent = 0;
                }
                for (var i = 0; i < padIdx; i++) {
                    padding += space;
                }
                outStr += padding + node + '\r\n';
                padIdx += indent;
            });
            return outStr;
        };
    </script>
</body>

</html>